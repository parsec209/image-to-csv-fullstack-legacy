<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CellValueGenerator</title>
</head>
<body>
    <p>
      This module contains the methods used for obtaining CSV cell section values from an uploaded file's text. Some of the 
      methods are relatively straightforward. For instance, the "pattern" method searches for text that matches a regular expression 
      provided by the user. It will search for the nth occurence of a match, depending on the string count selected. 
      The "customValue" is just a literal value provided by the user, no doc text parsing necessary. The "today" method uses today's date
      (more specifically the date from the user's browser) as the value.
      <br>
      <br>
      The positional "topPhrase" and "leftPhrase" methods are a bit more complicated. These methods use an "anchor phrase" provided by the user, meaning a phrase within a 
      recurring document that has the following constants: 1) it is always in the same exact position of the document relative to the sought-after metadata value (which will be used
      as the cell section value), and 2) it is always the same exact phrase in each document. Secondly, we need to define the terms "phrase" and "word," since they have special meanings in the context 
      of this application. A phrase is a single line of text consisting of characters (including special chars) no more than one space apart from each other. 
      A phrase ends when a character is proceeded by two or more spaces, a line break, or a page break. So in a nutshell, a phrase is a group of one or more words, which leads us to the
      definition of a word: a group of one or more characters (including special chars) with no space in between them; a word terminates with a space. The word definition here is an important distinction 
      from the word objects created by GCP's AnnotateImageResponse
      (the same word objects that comprise the word list, see WordListGenerator tutorial); 
      GCP assigns special chars within image files as words per se, since the API was designed more for natural language text. However, this application's use case is 
      more for documents such as invoices, so special characters can be combined together with regular characters to create words. 
      So when one of these two positional methods is selected (left- or topPhrase), the application will first parse the word list for the anchor phrase, and once that is found, it starts 
      another parse cycle for the cell section value (starting at the first character immediately proceeding the last character of the anchor phrase).
      The way it parses for the cell section value depends on the method (topPhrase or leftPhrase), type of string (word or phrase), and string count chosen.
      <br>
      <br>
      If the leftPhrase option is selected, and assuming the anchor phrase is found, the word list array is then parsed for a word or phrase located <i>n</i> string counts 
      after the anchor phrase. The application will skip over text that does not strictly adhere to the definition of phrase or word mentioned before. If the type of string selected is a phrase, 
      and the string count is three, then the cell section value will be the third phrase in the document located after the anchor phrase. And if the string type selected
      is word instead of phrase, with everything else being the same, the cell section value will be the third word found after the anchor phrase. It is important to note 
      that if the anchor phrase terminates in the middle of a phrase or word, the remainder of that phrase or word would be considered the first string count, since as 
      mentioned before, the parsing cycle for the cell section value begins with the first char immediately proceeding the anchor phrase. 
      <br>
      <br>
      If the topPhrase option is selected, and assuming the anchor phrase is found, the word list array is then parsed for a word or phrase located <i>n</i> string counts 
      directly beneath the anchor phrase. "Directly beneath," in this context, means the first word or phrase of a line that shares an x-coordinate 
      with the anchor phrase, and any additional words/phrases in that same line, even if they also share an x-coord with the anchor phrase, will not be included in the cell section value
      or string count. Secondly, words/phrases are determined to be on the same line if they share at least half of their y-coordinates with each other. If the image supplied is of good quality, 
      the application will be able to accurately distinguish which line a piece of text belongs to. As an example, if the type of string selected is a phrase, 
      and the string count is three, the application will look for the first phrase of a line that horizontally overlaps the anchor phrase, and it will repeat this process for three lines  
      beneath the anchor phrase. The phrase from the third line will be used as the cell section value. Note that each line needs to be populated with a phrase directly 
      beneath the anchor phrase for it to be included in the string count; empty lines are ignored. Same concept if 
      word is selected as the string type: the application will look for the first horizontally-overlapping word of a line for three lines beneath the anchor phrase, and the word on the 
      third line will be used as the cell section value.  
    </p>
</body>
</html>