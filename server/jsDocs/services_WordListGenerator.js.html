<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: services/wordListGenerator.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: services/wordListGenerator.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * wordListGenerator module - see {@tutorial wordListGenerator-tutorial}
 * @module wordListGenerator
 */

const { validateArgs, schemas } = require('../util/argsValidator')



// @ts-check
 

/**
 * Puts all the doc words from an image annotation response into a 2D array, consisting of the doc (outer) and its pages (inner)
 * @param {DocText} docText - Doc text containing the words
 * @returns {WordList} - Word list 
 */
const getWordList = function(docText) {
  validateArgs(arguments, { 0: schemas.docText })
  const docWords = []
  docText.extraction.forEach(function(docPage) {
    const pageWords = []
    //fullTextAnnotation is null for a page with no text
    if (docPage.fullTextAnnotation) {
      //the pages property of the fullTextAnnotation will always have length of 1; in this case it is a somewhat misleading name and is not to be confused with docPage, which is an actual page of the doc
      docPage.fullTextAnnotation.pages.forEach(function(page) {
        page.blocks.forEach(function(block) {
          block.paragraphs.forEach(function(paragraph) {
            paragraph.words.forEach(function(word) {
              pageWords.push(word)
            })       
          })
        })
      })
    }
    docWords.push(pageWords)
  })
  return { fileName: docText.fileName, words: docWords }
}


/**
 * Sorts words in the word list by their coordinates (left to right, line by line)
 * @param {WordList} wordList - Word list
 * @returns {void}
 */
const sortWordList = function(wordList) {
  validateArgs(arguments, { 0: schemas.wordList })
  wordList.words.forEach(function(page) {
    if (page.length) {
      page.sort(function(a, b) {    
        let vertexType = a.boundingBox.vertices.length ? 'vertices' : 'normalizedVertices'

        //if word A's bottom y coordinate is less than the vertical midpoint of word B, word A is sorted before word B
        if (a.boundingBox[vertexType][2].y &lt; (b.boundingBox[vertexType][0].y + b.boundingBox[vertexType][2].y)/2) {
          return -1

          //if word A's vertical midpoint is greater than the bottom y coordinate of word B, word A is sorted after word B
        } else if ((a.boundingBox[vertexType][0].y + a.boundingBox[vertexType][2].y)/2 > b.boundingBox[vertexType][2].y) {
          return 1

          //if neither of the preceding statements is true, then the word with the lesser left x coordinate gets sorted first
        } else {
          return 0 || a.boundingBox[vertexType][0].x - b.boundingBox[vertexType][0].x
        }
      })
    }
  })
}



module.exports = { getWordList, sortWordList }
 
 
 </code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Img-To-CSV Services</a></h2><h3>Modules</h3><ul><li><a href="module-cellValueGenerator.html">cellValueGenerator</a></li><li><a href="module-CSVGenerator.html">CSVGenerator</a></li><li><a href="module-CSVWriter.html">CSVWriter</a></li><li><a href="module-passwordReset.html">passwordReset</a></li><li><a href="module-postService.html">postService</a></li><li><a href="module-textExtractor.html">textExtractor</a></li><li><a href="module-uploader.html">uploader</a></li><li><a href="module-wordListGenerator.html">wordListGenerator</a></li><li><a href="module-zipWriter.html">zipWriter</a></li></ul><h3>Classes</h3><ul><li><a href="InputError.html">InputError</a></li><li><a href="module-cellValueGenerator-CellValueGenerator.html">CellValueGenerator</a></li><li><a href="module-postService-PostService.html">PostService</a></li><li><a href="module-uploader-Uploader.html">Uploader</a></li><li><a href="module-zipWriter-ZipWriter.html">ZipWriter</a></li></ul><h3>Tutorials</h3><ul><li><a href="tutorial-cellValueGenerator-tutorial.html">cellValueGenerator</a></li><li><a href="tutorial-CSVGenerator-tutorial.html">CSVGenerator</a></li><li><a href="tutorial-wordListGenerator-tutorial.html">wordListGenerator</a></li></ul><h3><a href="global.html">Global</a></h3>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Sep 26 2021 22:39:09 GMT-0400 (Eastern Daylight Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
